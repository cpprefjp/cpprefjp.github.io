<h1>aligned_union (C++11)</h1>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">namespace std {
  template &lt;std::size_t Len,
            class... Types&gt;
  struct aligned_union {
    typedef … type;
    static constexpr std::size_t alignment_value = …;
  };
}</span></code></pre>
</p>
<h2>概要</h2>
<p>アラインメント調整された共用体領域を作る。</p>
<h2>要件</h2>
<p><code><span style="color: #000">Types...</span></code>に、1個以上の型が与えられること。</p>
<h2>効果</h2>
<p><code><span style="color: #000">aligned_union</span></code>は、領域サイズ<code><span style="color: #000">Len</span></code>、要素型列<code><span style="color: #000">Types...</span></code>で調整した未初期化の共用体領域をメンバ型<code><span style="color: #000">type</span></code>として定義する。<br />
<code><span style="color: #000">Types...</span></code>のいずれかの型が非POD型だとしても、メンバ型<code><span style="color: #000">type</span></code>はPOD型となる(参照：<a href="http://cpprefjp.github.io/reference/type_traits/is_pod.html"><code><span style="color: #000">is_pod</span></code></a>)。  </p>
<p>また、<code><span style="color: #000">Types...</span></code>全ての厳格なアラインメント値を、<code><span style="color: #000">std::size_t</span></code>型の静的メンバ定数<code><span style="color: #000">alignment_value</span></code>として定義する。</p>
<h2>例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;type_traits&gt;

union X {
  int n;
  std::string s;

  X(const char* str)
    : s(str) {}
};

int main()
{
  typedef std::aligned_union&lt;sizeof(X), int, std::string&gt; aligned_X;

  aligned_X::type x;

  new (&amp;x) X("hello");

  std::cout &lt;&lt; reinterpret_cast&lt;X&amp;&gt;(x).s &lt;&lt; std::endl;
  std::cout &lt;&lt; aligned_X::alignment_value &lt;&lt; std::endl;
}</span></code></pre>
</p>
<h3>出力例(アラインメント値は処理系定義)</h3>
<p><pre><code><span style="color: #000">hello
8
</span></code></pre></p>
<h2>バージョン</h2>
<h3>言語</h3>
<ul>
<li>C++11</li>
</ul>
<h3>処理系</h3>
<ul>
<li><a href="http://cpprefjp.github.io/implementation.html#clang">Clang</a>: 3.3</li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC, C++0x mode</a>: </li>
<li><a href="http://cpprefjp.github.io/implementation.html#visual_cpp">Visual C++</a>: ??</li>
</ul>
<h2>参照</h2>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1877.pdf" target="_blank">N1877 Adding Alignment Support to the C++ Programming Language</a></li>
</ul>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/type_traits/aligned_union.md" target="_blank">編集</a></footer>