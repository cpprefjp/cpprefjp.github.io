<h1>set_new_handler</h1>
<p><pre class="codehilite"><code class="language-cpp"><a href="http://cpprefjp.github.io/reference/new/new_handler.html">new_handler</a> set_new_handler(<a href="http://cpprefjp.github.io/reference/new/new_handler.html">new_handler</a> new_p) noexcept;
}<span style="color: #000">namespace std {
  </span></code></pre>
</p>
<h2>概要</h2>
<p><code><span style="color: #000">new</span></code>失敗時に呼ばれる関数を設定する。 </p>
<p><code><span style="color: #000">new</span></code>失敗時にはデフォルトで<a href="http://cpprefjp.github.io/reference/new/bad_alloc.html"><code><span style="color: #000">bad_alloc</span></code></a>例外が投げられるが、この関数を使用することで<code><span style="color: #000">new</span></code>失敗時の挙動を切り替えられる。</p>
<h2>効果</h2>
<p><code><span style="color: #000">new_p</span></code>関数を、<code><span style="color: #000">new</span></code>失敗時に呼ばれる関数として設定する。 
パラメータとしてヌルポインタが渡された場合、初期のハンドラが設定される。</p>
<h2>戻り値</h2>
<p>この関数が呼ばれる前に設定されていた関数を返す</p>
<h2>例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color:#ff0000">set_new_handler</span>(on_new_failed);

  int* p = new int[std::numeric_limits&lt;std::size_t&gt;::max()];
}<span style="color: #000">#include &lt;iostream&gt;
#include &lt;new&gt;
#include &lt;limits&gt;
#include &lt;cstdlib&gt;

void on_new_failed()
{
  // エラー理由を出力し、プログラムを異常終了させる
  std::cout &lt;&lt; "メモリ確保に失敗した" &lt;&lt; std::endl;
  std::abort();
}

int main()
{
  // new失敗時の動作をカスタマイズ
  std::</span></code></pre>
</p>
<h3>出力例</h3>
<p><pre><code><span style="color: #000">メモリ確保に失敗した

This application has requested the Runtime to terminate it in an unusual way.
Please contact the application's support team for more information.&lt;/span&gt;
</span></code></pre></p>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/new/set_new_handler.md" target="_blank">編集</a></footer>