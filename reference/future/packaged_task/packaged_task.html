<h1>コンストラクタ (C++11)</h1>
<p><pre class="codehilite"><code class="language-cpp"><a href="http://cpprefjp.github.io/reference/memory/allocator_arg_t.html">allocator_arg_t</a>, const Allocator&amp; a, F&amp;&amp; f);
packaged_task(packaged_task&amp;) = delete;
packaged_task(packaged_task&amp;&amp; rhs) noexcept;<span style="color: #000">packaged_task() noexcept;
template &lt;class F&gt;
explicit packaged_task(F&amp;&amp; f);
template &lt;class F, class Allocator&gt;
explicit packaged_task(</span></code></pre>
</p>
<h2>packaged_taskオブジェクトの構築</h2>
<ul>
<li><code><span style="color: #000">packaged_task() noexcept;</span></code><br />デフォルトコンストラクタ。共有状態なし、タスクの保持なしでオブジェクトを構築する。</li>
<li><code><span style="color: #000">template &lt;class F&gt;</span></code><br /><code><span style="color: #000">explicit packaged_task(F&amp;&amp; f);</span></code><br />関数オブジェクトを受け取るコンストラクタ。共有状態を初期化し、<code><span style="color: #000">f</span></code>を非同期実行するタスクとして<code><span style="color: #000">std::</span></code><a href="http://cpprefjp.github.io/reference/utility/forward.html"><code><span style="color: #000">forward</span></code></a><code><span style="color: #000">&lt;F&gt;(f)</span></code>でメンバ変数に保持する。<br />例外： <code><span style="color: #000">F</span></code>のコピーコンストラクタもしくはムーブコンストラクタによって送出されうる、あらゆる例外が投げられる可能性がある。</li>
<li><code><span style="color: #000">template &lt;class F, class Allocator&gt;</span></code><br /><code><span style="color: #000">explicit packaged_task(allocator_arg_t, const Allocator&amp; a, F&amp;&amp; f);</span></code><br />関数オブジェクトおよびカスタムアロケータを受け取るコンストラクタ。共有状態を初期化し、<code><span style="color: #000">f</span></code>を非同期実行するタスクとして<code><span style="color: #000">std::</span></code><a href="http://cpprefjp.github.io/reference/utility/forward.html"><code><span style="color: #000">forward</span></code></a><code><span style="color: #000">&lt;F&gt;(f)</span></code>でメンバ変数に保持する。アロケータ<code><span style="color: #000">a</span></code>は、共有状態を構築する際に、その内部構造でメモリ確保が必要な場合に使用される。<br />例外： <code><span style="color: #000">F</span></code>のコピーコンストラクタもしくはムーブコンストラクタによって送出されうる、あらゆる例外が投げられる可能性がある。内部構造のメモリ確保に失敗した場合、<code><span style="color: #000">std::</span></code><a href="http://cpprefjp.github.io/reference/new/bad_alloc.html"><code><span style="color: #000">bad_alloc</span></code></a>が投げられる。</li>
<li><code><span style="color: #000">packaged_task(const packaged_task&amp;) = delete;</span></code><br />コピーコンストラクタ。コピー不可。</li>
<li><code><span style="color: #000">packaged_task(packaged_task&amp;&amp; rhs) noexcept;</span></code><br />ムーブコンストラクタ。<code><span style="color: #000">rhs</span></code>の共有状態の所有権、および非同期タスクの関数オブジェクトを<code><span style="color: #000">*this</span></code>に移動する。<br />事後条件： <code><span style="color: #000">rhs</span></code>は共有状態を持たない</li>
</ul>
<h2>例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">#include &lt;memory&gt;
#include &lt;future&gt;

int foo() { return 3; }

int main()
{
  // デフォルト構築
  // 共有状態とタスクを持たない
  {
    std::packaged_task&lt;int()&gt; task;
  }

  // 関数オブジェクトを受け取って構築
  // 共有状態の初期化、およびタスクを内部に保持する
  {
    std::packaged_task&lt;int()&gt; task(foo);
  }

  // 関数オブジェクトとアロケータを受け取って構築
  // 共有状態をアロケータを使用して初期化子、タスクを内部に保持する
  {
    std::packaged_task&lt;int()&gt; task {
        std::allocator_arg,
        std::allocator&lt;std::packaged_task&lt;int()&gt;&gt;(),
        foo
    };
  }

  // ムーブ構築
  // 共有状態の所有権とタスクを移動する
  {
    std::packaged_task&lt;int()&gt; task1(foo);
    std::packaged_task&lt;int()&gt; task2 = std::move(task1);

    // task1は共有状態を持たない
  }
}</span></code></pre>
</p>
<h3>出力</h3>
<p><pre><code><span style="color: #000"></span></code></pre></p>
<h2>バージョン</h2>
<h3>言語</h3>
<ul>
<li>C++11</li>
</ul>
<h3>処理系</h3>
<ul>
<li><a href="http://cpprefjp.github.io/implementation.html#clang">Clang</a>: ??</li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC</a>: </li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC, C++0x mode</a>: 4.7.0</li>
<li><a href="http://cpprefjp.github.io/implementation.html#icc">ICC</a>: ??</li>
<li><a href="http://cpprefjp.github.io/implementation.html#visual_cpp">Visual C++</a>: 11.0 （11.0はアロケータを引数に取るものがコンパイルできない？）</li>
</ul>
<h2>参照</h2>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/future/packaged_task/packaged_task.md" target="_blank">編集</a></footer>