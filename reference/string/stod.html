<h1>stod (C++11)</h1>
<p><pre class="codehilite"><code class="language-cpp"><a href="http://cpprefjp.github.io/reference/cstddef/size_t.html">size_t</a>* idx = nullptr);
  double stod(const wstring&amp; str, <a href="http://cpprefjp.github.io/reference/cstddef/size_t.html">size_t</a>* idx = nullptr);
}<span style="color: #000">namespace std {
  double stod(const string&amp; str, </span></code></pre>
</p>
<h2>概要</h2>
<p>文字列<code><span style="color: #000">str</span></code>を数値として読み取って、<code><span style="color: #000">double</span></code>型の値に変換する。</p>
<h2>効果</h2>
<p>パラメータ<code><span style="color: #000">str</span></code>が<code><span style="color: #000">string</span></code>型であれば<code><span style="color: #000">std::strtod(str.c_str(), &amp;end)</span></code>、<code><span style="color: #000">wstring</span></code>であれば<code><span style="color: #000">std::wcstod(str.c_str(), &amp;end)</span></code>を呼び出して、その戻り値を返す。</p>
<p>パラメータ<code><span style="color: #000">idx</span></code>が非<code><span style="color: #000">nullptr</span></code>の場合、変換に使用されなかった要素のインデックス（<code><span style="color: #000">end - str.c_str()</span></code>）が格納される。</p>
<h2>戻り値</h2>
<p>変換して得られた数値が返される。</p>
<h2>例外</h2>
<ul>
<li>数値への変換が行われなかった場合、<a href="http://cpprefjp.github.io/reference/stdexcept.html"><code><span style="color: #000">std::invalid_argument</span></code></a>が送出される。</li>
<li>結果が範囲外の値になった場合（<code><span style="color: #000">errno</span></code>が<code><span style="color: #000">ERANGE</span></code>となった場合）、<a href="http://cpprefjp.github.io/reference/stdexcept.html"><code><span style="color: #000">std::out_of_range</span></code></a>が送出される。</li>
</ul>
<h2>備考</h2>
<h3>errnoの扱い</h3>
<ul>
<li>Visual C++ 11やGCC (libstdc++) 4.8.2では、この関数を呼び出すと<code><span style="color: #000">errno</span></code>の値が変更される。</li>
<li>Clang (libc++) 3.3では、この関数の呼び出し前後で<code><span style="color: #000">errno</span></code>の値は変化しない。</li>
</ul>
<h3>グローバルロケールの影響</h3>
<p>この関数は、<code><span style="color: #000">setlocale()</span></code>関数により挙動が変化する。</p>
<ul>
<li><code><span style="color: #000">strtod()</span></code>関数での文字列先頭の空白を読み飛ばす処理に、<code><span style="color: #000">&lt;cctype&gt;</span></code>の<code><span style="color: #000">isspace()</span></code>関数が使用される。</li>
<li>小数点記号は<code><span style="color: #000">LC_NUMERIC</span></code>で指定されたものが使用される。</li>
</ul>
<h2>例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">#include &lt;iostream&gt;
#include &lt;string&gt;

int main()
{
  // 十進法での変換
  std::cout &lt;&lt; "---- decimal point" &lt;&lt; std::endl;

  double a = std::stod("1.5"); // std::stod("1.5", nullptr);
  std::cout &lt;&lt; a &lt;&lt; std::endl;

  double aw = std::stod(L"1."); // std::stod(L"1.", nullptr);
  std::cout &lt;&lt; aw &lt;&lt; std::endl;

  // 指数表記の変換
  std::cout &lt;&lt; "---- base = 8" &lt;&lt; std::endl;

  double b = std::stod("0.5e3", nullptr);
  std::cout &lt;&lt; b &lt;&lt; std::endl;

  double bw = std::stod(L".25e3", nullptr);
  std::cout &lt;&lt; bw &lt;&lt; std::endl;

  // 十六進法での変換
  std::cout &lt;&lt; "---- base = 16" &lt;&lt; std::endl;

  double c = std::stod("0x1.2P3", nullptr);
  std::cout &lt;&lt; c &lt;&lt; std::endl;

  double cw = std::stod(L"0x1.2P4", nullptr);
  std::cout &lt;&lt; cw &lt;&lt; std::endl;

  // 2番目の仮引数の使用例
  std::cout &lt;&lt; "---- use of idx parameter" &lt;&lt; std::endl;

  std::string es = "30.75%";
  std::size_t ei;
  double e = std::stod(es, &amp;ei);
  std::cout &lt;&lt; e &lt;&lt; ' ' &lt;&lt; es[ei] &lt;&lt; std::endl;

  std::wstring ews = L"32%";
  std::size_t ewi;
  double ew = std::stod(ews, &amp;ewi);
  std::cout &lt;&lt; ew &lt;&lt; ' ' &lt;&lt; ewi &lt;&lt; std::endl;

  // 文字列先頭に空白がある場合
  std::cout &lt;&lt; "---- space character before number" &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stod("    -1") &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stod(L"    -.25") &lt;&lt; std::endl;
}</span></code></pre>
</p>
<h3>出力例</h3>
<p><pre><code><span style="color: #000">1.5
1
500
250
---- base = 16
9
18
---- use of idx parameter
30.75 %
32 2
---- space character before number
-1
-0.25
</span></code></pre></p>
<h2>実装例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">double stod(const string&amp; str, size_t* idx = nullptr) {
  const char* p = str.c_str();
  char* end;
  errno = 0;
  double x = strtod(p, &amp;end);
  if (p == end) {
    throw invalid_argument("stod");
  }
  if (errno == ERANGE) {
    throw out_of_range("stod");
  }
  if (idx != nullptr) {
    *idx = static_cast&lt;std::size_t&gt;(end - p);
  }
  return x;
}

double stod(const wstring&amp; str, size_t* idx = nullptr) {
  const wchar_t* p = str.c_str();
  wchar_t* end;
  errno = 0;
  double x = wcstod(p, &amp;end);
  if (p == end) {
    throw invalid_argument("stod");
  }
  if (errno == ERANGE) {
    throw out_of_range("stod");
  }
  if (idx != nullptr) {
    *idx = static_cast&lt;std::size_t&gt;(end - p);
  }
  return x;
}</span></code></pre>
</p>
<h2>バージョン</h2>
<h3>言語</h3>
<ul>
<li>C++11</li>
</ul>
<h3>処理系</h3>
<ul>
<li><a href="http://cpprefjp.github.io/implementation.html#clang">Clang</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC, C++11 mode</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#icc">ICC</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#visual_cpp">Visual C++</a>: 10.0, 11.0, 12.0</li>
</ul>
<p>ただし、Visual C++ 10.0, 11.0は十六進法に対応していない（12.0は未確認）。</p>
<h2>参照</h2>
<h3>C標準ライブラリに由来する関数</h3>
<ul>
<li><code><span style="color: #000">atof</span></code>: <code><span style="color: #000">stod</span></code>は<code><span style="color: #000">atof</span></code>を<code><span style="color: #000">std::string</span></code>および<code><span style="color: #000">std::wsting</span></code>に対応させたものと見なせる。</li>
<li><code><span style="color: #000">strtod</span></code>, <code><span style="color: #000">wcstod</span></code>: <code><span style="color: #000">stod</span></code>は<code><span style="color: #000">strtod</span></code>および<code><span style="color: #000">wcstod</span></code>をそれぞれ<code><span style="color: #000">std::string</span></code>と<code><span style="color: #000">std::wsting</span></code>に対応させたものと見なせる。</li>
</ul>
<h3>ファミリー</h3>
<ul>
<li><a href="http://cpprefjp.github.io/reference/string/stoi.html"><code><span style="color: #000">stoi</span></code></a>: 戻り値の型が<code><span style="color: #000">int</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stol.html"><code><span style="color: #000">stol</span></code></a>: 戻り値の型が<code><span style="color: #000">long</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stoll.html"><code><span style="color: #000">stoll</span></code></a>: 戻り値の型が<code><span style="color: #000">long long</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stoul.html"><code><span style="color: #000">stoul</span></code></a>: 戻り値の型が<code><span style="color: #000">unsigned long</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stoull.html"><code><span style="color: #000">stoull</span></code></a>: 戻り値の型が<code><span style="color: #000">unsigned long long</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stof.html"><code><span style="color: #000">stof</span></code></a>: 戻り値の型が<code><span style="color: #000">float</span></code>となったもの。</li>
<li>(<code><span style="color: #000">stod</span></code>: この関数自身)</li>
<li><a href="http://cpprefjp.github.io/reference/string/stold.html"><code><span style="color: #000">stold</span></code></a>: 戻り値の型が<code><span style="color: #000">long double</span></code>となったもの。</li>
</ul>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/string/stod.md" target="_blank">編集</a></footer>