<h1>stol (C++11)</h1>
<p><pre class="codehilite"><code class="language-cpp"><a href="http://cpprefjp.github.io/reference/cstddef/size_t.html">size_t</a>* idx = nullptr, long base = 10);
  long stol(const wstring&amp; str, <a href="http://cpprefjp.github.io/reference/cstddef/size_t.html">size_t</a>* idx = nullptr, long base = 10);
}<span style="color: #000">namespace std {
  long stol(const string&amp; str, </span></code></pre>
</p>
<h2>概要</h2>
<p>文字列<code><span style="color: #000">str</span></code>を数値として読み取って、<code><span style="color: #000">long</span></code>型の値に変換する。</p>
<h2>効果</h2>
<p>パラメータ<code><span style="color: #000">str</span></code>が<code><span style="color: #000">string</span></code>型であれば<code><span style="color: #000">std::strtol(str.c_str(), &amp;end, base)</span></code>、<code><span style="color: #000">wstring</span></code>型であれば<code><span style="color: #000">std::wcstol(str.c_str(), &amp;end, base)</span></code>を呼び出して、その戻り値を返す。</p>
<p>パラメータ<code><span style="color: #000">idx</span></code>が非<code><span style="color: #000">nullptr</span></code>の場合、変換に使用されなかった要素のインデックス（<code><span style="color: #000">end - str.c_str()</span></code>）が格納される。</p>
<p>パラメータ<code><span style="color: #000">base</span></code>は、整数文字列<code><span style="color: #000">str</span></code>の基数を表す。デフォルトでは<code><span style="color: #000">10</span></code>進数として文字列を整数に変換する。基数は<code><span style="color: #000">2</span></code>から<code><span style="color: #000">36</span></code>(<code><span style="color: #000">36</span></code>含む)進数を指定できる。基数を<code><span style="color: #000">0</span></code>とした場合は、文字列のプレフィックスから基数が自動的に選択される。自動的な選択のルールは、以下のようになる：</p>
<ul>
<li>先頭が<code><span style="color: #000">0</span></code>：<code><span style="color: #000">8</span></code>進数</li>
<li>先頭が<code><span style="color: #000">0x</span></code>もしくは<code><span style="color: #000">0X</span></code>：<code><span style="color: #000">16</span></code>進数</li>
</ul>
<h2>戻り値</h2>
<p>変換して得られた数値が返される。</p>
<h2>例外</h2>
<ul>
<li>数値への変換が行われなかった場合、<a href="http://cpprefjp.github.io/reference/stdexcept.html"><code><span style="color: #000">std::invalid_argument</span></code></a>が送出される。</li>
<li>結果が範囲外の値になった場合、<a href="http://cpprefjp.github.io/reference/stdexcept.html"><code><span style="color: #000">std::out_of_range</span></code></a>が送出される。</li>
</ul>
<h2>備考</h2>
<h3>errnoの扱い</h3>
<ul>
<li>Visual C++ 11やGCC (libstdc++) 4.8.2では、この関数を呼び出すと<code><span style="color: #000">errno</span></code>の値が変更される。</li>
<li>Clang (libc++) 3.3では、この関数の呼び出し前後で<code><span style="color: #000">errno</span></code>の値は変化しない。</li>
</ul>
<h3>グローバルロケールの影響</h3>
<p>この関数は、<code><span style="color: #000">setlocale()</span></code>関数により挙動が変化する。</p>
<p><code><span style="color: #000">strtol()</span></code>関数での文字列先頭の空白を読み飛ばす処理に、<code><span style="color: #000">&lt;cctype&gt;</span></code>の<code><span style="color: #000">isspace()</span></code>関数が使用されるためである。</p>
<h2>例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">#include &lt;iostream&gt;
#include &lt;string&gt;

int main()
{
  // 十進法での変換
  std::cout &lt;&lt; "---- base = 10" &lt;&lt; std::endl;

  long a = std::stol("10"); // std::stol("10", nullptr, 10);
  std::cout &lt;&lt; a &lt;&lt; std::endl;

  long aw = std::stol(L"11"); // std::stol(L"11", nullptr, 10);
  std::cout &lt;&lt; aw &lt;&lt; std::endl;

  // 八進法での変換
  std::cout &lt;&lt; "---- base = 8" &lt;&lt; std::endl;

  long b = std::stol("10", nullptr, 8);
  std::cout &lt;&lt; b &lt;&lt; std::endl;

  long bw = std::stol(L"10", nullptr, 8);
  std::cout &lt;&lt; bw &lt;&lt; std::endl;

  // 十六進法での変換
  std::cout &lt;&lt; "---- base = 16" &lt;&lt; std::endl;

  long c = std::stol("10", nullptr, 16);
  std::cout &lt;&lt; c &lt;&lt; std::endl;

  long cw = std::stol(L"11", nullptr, 16);
  std::cout &lt;&lt; cw &lt;&lt; std::endl;

  // 十六進法での変換（プレフィックス付き）
  long d = std::stol("0x20", nullptr, 16);
  std::cout &lt;&lt; d &lt;&lt; std::endl;

  long dw = std::stol(L"0x21", nullptr, 16);
  std::cout &lt;&lt; dw &lt;&lt; std::endl;

  // base = 0による十進法・八進法・十六進法の自動判別
  std::cout &lt;&lt; "---- base = 0" &lt;&lt; std::endl;

  std::cout &lt;&lt; std::stol("100", nullptr, 0) &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stol("0100", nullptr, 0) &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stol("0x100", nullptr, 0) &lt;&lt; std::endl;

  std::cout &lt;&lt; std::stol(L"100", nullptr, 0) &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stol(L"0100", nullptr, 0) &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stol(L"0x100", nullptr, 0) &lt;&lt; std::endl;

  // 2番目の仮引数の使用例
  std::cout &lt;&lt; "---- use of idx parameter" &lt;&lt; std::endl;

  std::string es = "30%";
  std::size_t ei;
  long e = std::stol(es, &amp;ei);
  std::cout &lt;&lt; e &lt;&lt; ' ' &lt;&lt; es[ei] &lt;&lt; std::endl;

  std::wstring ews = L"31%";
  std::size_t ewi;
  long ew = std::stol(ews, &amp;ewi);
  std::cout &lt;&lt; ew &lt;&lt; ' ' &lt;&lt; ewi &lt;&lt; std::endl;

  // 文字列先頭に空白がある場合
  std::cout &lt;&lt; "---- space character before number" &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stol("    -1") &lt;&lt; std::endl;
  std::cout &lt;&lt; std::stol(L"    -2") &lt;&lt; std::endl;
}</span></code></pre>
</p>
<h3>出力</h3>
<p><pre><code><span style="color: #000">---- base = 10
10
11
---- base = 8
8
9
---- base = 16
16
17
32
33
---- base = 0
100
64
256
100
64
256
---- use of idx parameter
30 %
31 index: 2
---- space character before number
-1
-2
</span></code></pre></p>
<h2>実装例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">long stol(const string&amp; str, size_t* idx = nullptr, long base = 10) {
  const char* p = str.c_str();
  char* end;
  errno = 0;
  long x = strtol(p, &amp;end, base);
  if (p == end) {
    throw invalid_argument("stol");
  }
  if (errno == ERANGE) {
    throw out_of_range("stol");
  }
  if (idx != nullptr) {
    *idx = static_cast&lt;std::size_t&gt;(end - p);
  }
  return x;
}

long stol(const wstring&amp; str, size_t* idx = nullptr, long base = 10) {
  const wchar_t* p = str.c_str();
  wchar_t* end;
  errno = 0;
  long x = wcstol(p, &amp;end, base);
  if (p == end) {
    throw invalid_argument("stol");
  }
  if (errno == ERANGE) {
    throw out_of_range("stol");
  }
  if (idx != nullptr) {
    *idx = static_cast&lt;std::size_t&gt;(end - p);
  }
  return x;
}</span></code></pre>
</p>
<h2>バージョン</h2>
<h3>言語</h3>
<ul>
<li>C++11</li>
</ul>
<h3>処理系</h3>
<ul>
<li><a href="http://cpprefjp.github.io/implementation.html#clang">Clang</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC, C++11 mode</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#icc">ICC</a>: ?</li>
<li><a href="http://cpprefjp.github.io/implementation.html#visual_cpp">Visual C++</a>: 10.0, 11.0, 12.0</li>
</ul>
<h2>参照</h2>
<h3>C標準ライブラリに由来する関数</h3>
<ul>
<li><code><span style="color: #000">atol</span></code>: <code><span style="color: #000">stol</span></code>は<code><span style="color: #000">atol</span></code>を<code><span style="color: #000">std::string</span></code>および<code><span style="color: #000">std::wsting</span></code>に対応させたものと見なせる。</li>
<li><code><span style="color: #000">strtol</span></code>, <code><span style="color: #000">wcstol</span></code>: <code><span style="color: #000">stol</span></code>は<code><span style="color: #000">strtol</span></code>および<code><span style="color: #000">wcstol</span></code>をそれぞれ<code><span style="color: #000">std::string</span></code>と<code><span style="color: #000">std::wsting</span></code>に対応させたものと見なせる。</li>
</ul>
<h3>ファミリー</h3>
<ul>
<li><a href="http://cpprefjp.github.io/reference/string/stoi.html"><code><span style="color: #000">stoi</span></code></a>: 戻り値の型が<code><span style="color: #000">int</span></code>となったもの。</li>
<li>(<code><span style="color: #000">stol</span></code>: この関数自身)</li>
<li><a href="http://cpprefjp.github.io/reference/string/stoll.html"><code><span style="color: #000">stoll</span></code></a>: 戻り値の型が<code><span style="color: #000">long long</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stoul.html"><code><span style="color: #000">stoul</span></code></a>: 戻り値の型が<code><span style="color: #000">unsigned long</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stoull.html"><code><span style="color: #000">stoull</span></code></a>: 戻り値の型が<code><span style="color: #000">unsigned long long</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stof.html"><code><span style="color: #000">stof</span></code></a>: 戻り値の型が<code><span style="color: #000">float</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stod.html"><code><span style="color: #000">stod</span></code></a>: 戻り値の型が<code><span style="color: #000">double</span></code>となったもの。</li>
<li><a href="http://cpprefjp.github.io/reference/string/stold.html"><code><span style="color: #000">stold</span></code></a>: 戻り値の型が<code><span style="color: #000">long double</span></code>となったもの。</li>
</ul>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/string/stol.md" target="_blank">編集</a></footer>