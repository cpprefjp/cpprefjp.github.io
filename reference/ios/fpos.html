<h1>fpos</h1>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">namespace std {
  template &lt;class stateT&gt;
  class fpos;
}</span></code></pre>

<code><span style="color: #000">fpos</span></code>は、ファイル上の位置を表現するクラスである。
概念的には、stateTによる変換状態と整数によるオフセットでファイル上の位置を表現するクラスである。</p>
<p>多くの場合、stateTとしては<code><span style="color: #000">std::mbstate_t</span></code>が使用される。とくに、<code><span style="color: #000">&lt;iosfwd&gt;</span></code>ヘッダでは、以下の2つのtypedefが定義されている。</p>
<ul>
<li><code><span style="color: #000">fpos&lt;char_traits&lt;char&gt;::state_type&gt;</span></code>のtypedefとして<code><span style="color: #000">streampos</span></code></li>
<li><code><span style="color: #000">fpos&lt;char_traits&lt;wchar_t&gt;::state_type&gt;</span></code>のtypedefとして<code><span style="color: #000">wstreampos</span></code></li>
</ul>
<p><code><span style="color: #000">std::char_traits&lt;char&gt;::state_type</span></code>と<code><span style="color: #000">std::char_traits&lt;wchar_t&gt;::state_type</span></code>はともに<code><span style="color: #000">std::mbstate_t</span></code>の<code><span style="color: #000">typedef</span></code>である。</p>
<h2>メンバ関数</h2>
<h3>構築・破棄</h3>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/ios/ios/state.html"><code><span style="color: #000">state</span></code></a></td>
<td>状態の取得・設定</td>
<td></td>
</tr>
</tbody>
</table>
<h2>要件</h2>
<p><code><span style="color: #000">fpos</span></code>に関連して、以下の操作が可能であることが要求される。</p>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>式・文</th>
<th>説明</th>
<th>アサーション・その他注釈</th>
</tr>
</thead>
<tbody>
<tr>
<td><code><span style="color: #000">P(i)</span></code></td>
<td>intからの一時オブジェクトの作成</td>
<td><code><span style="color: #000">p == P(i)</span></code></td>
</tr>
<tr>
<td><code><span style="color: #000">P p(i);</span></code></td>
<td>intからのオブジェクトの作成</td>
<td>事後条件: <code><span style="color: #000">p == P(i)</span></code></td>
</tr>
<tr>
<td><code><span style="color: #000">P p = i;</span></code></td>
<td>〃</td>
<td>〃</td>
</tr>
<tr>
<td><code><span style="color: #000">P(o)</span></code></td>
<td>オフセットからの（一時）オブジェクトの生成</td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">O(p)</span></code></td>
<td>オフセットへの変換</td>
<td><code><span style="color: #000">P(O(p)) == p</span></code></td>
</tr>
<tr>
<td><code><span style="color: #000">p == q</span></code></td>
<td>比較</td>
<td>結果の型はboolに変換可能である</td>
</tr>
<tr>
<td><code><span style="color: #000">p != q</span></code></td>
<td>〃</td>
<td>〃</td>
</tr>
<tr>
<td><code><span style="color: #000">q = p + o</span></code></td>
<td>正値のオフセット</td>
<td><code><span style="color: #000">q - o == p</span></code></td>
</tr>
<tr>
<td><code><span style="color: #000">p += o</span></code></td>
<td>〃</td>
<td>〃</td>
</tr>
<tr>
<td><code><span style="color: #000">q = p - o</span></code></td>
<td></td>
<td><code><span style="color: #000">q + o == p</span></code></td>
</tr>
<tr>
<td><code><span style="color: #000">q -= o</span></code></td>
<td></td>
<td>〃</td>
</tr>
<tr>
<td><code><span style="color: #000">o = p - q</span></code></td>
<td>fpos同士の差</td>
<td><code><span style="color: #000">q + o == p</span></code></td>
</tr>
<tr>
<td><code><span style="color: #000">streamsize(o)</span></code></td>
<td>型変換</td>
<td><code><span style="color: #000">streamsize(O(sz)) == sz</span></code></td>
</tr>
<tr>
<td><code><span style="color: #000">O(sz)</span></code></td>
<td>型変換</td>
<td>〃</td>
</tr>
</tbody>
</table>
<ul>
<li>P: fpos&lt;T&gt;である型</li>
<li>p, q: fpos&lt;T&gt;である型の値</li>
<li>O: streamoff型</li>
<li>o: streamoff型の値</li>
<li>sz: streamsize型の値</li>
<li>i: int型の値</li>
</ul>
<p>なお、<code><span style="color: #000">P(O(-1))</span></code>はエラー値である。<code><span style="color: #000">basic_istream</span></code>/<code><span style="color: #000">basic_ostream</span></code>/<code><span style="color: #000">basic_streambuf</span></code>では以下のように扱われる。</p>
<ul>
<li>戻り値としてこの値が返されれば、操作の失敗を表す。</li>
<li>引数としてこの値が渡された場合、挙動は未定義となる。</li>
</ul>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/ios/fpos.md" target="_blank">編集</a></footer>