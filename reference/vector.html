<h1>vector</h1>
<p><pre class="codehilite"><code class="language-cpp"><a href="http://cpprefjp.github.io/reference/memory/allocator.html">allocator</a>&lt;T&gt;&gt;
  class vector;
}<span style="color: #000">namespace std {
  template &lt;class T, class Allocator = </span></code></pre>

<code><span style="color: #000">vector</span></code>はシーケンスコンテナの一種で、各要素は線形に、順序を保ったまま格納される。</p>
<p><code><span style="color: #000">vector</span></code>コンテナは可変長配列として実装される。通常の(<code><span style="color: #000">new []</span></code>で確保した)配列と同じように、<code><span style="color: #000">vector</span></code>の各要素は連続して配置されるため、イテレータだけでなく添字による要素のランダムアクセスも高速である。</p>
<p>配列と違い、ストレージは<code><span style="color: #000">vector</span></code>自体が管理するため、自動的に領域の拡張が行われる。</p>
<p><code><span style="color: #000">vector</span></code>は次の点で優れている。</p>
<ul>
<li>各要素への添字アクセス(定数時間)</li>
<li>全要素の両方向の走査(線形時間)</li>
<li>末尾への要素の追加・削除(償却定数時間)</li>
</ul>
<p>これらの挙動は配列と同じパフォーマンス特性を示し、加えてストレージサイズの変更が非常に簡単である。ただし、<code><span style="color: #000">vector</span></code>は実際の要素数より少し余分にメモリを確保する(これは拡張に備え、パフォーマンス特性を満足するための仕様である)。</p>
<p>他の標準シーケンスコンテナと比べ、<code><span style="color: #000">vector</span></code>は要素アクセスと(末尾に対する)追加・削除において一般的に最高の性能を誇る。末尾以外に対する挿入・削除は<code><span style="color: #000">deque</span></code>や<code><span style="color: #000">list</span></code>に劣り、イテレータや要素への参照の安定性(無効になる操作の数)では<code><span style="color: #000">list</span></code>に劣る。</p>
<p>内部的には、<code><span style="color: #000">vector</span></code>は(他のすべてのコンテナと同じように)サイズ用のメンバ変数を持ち、格納されている要素数を管理している。しかし<code><span style="color: #000">vector</span></code>の場合は、さらに確保済みのメモリサイズを管理するキャパシティ用のメンバ変数を持ち、これは常に<code><span style="color: #000">size</span></code>と同じか大きい値となる。確保済みの領域の余計な部分は、要素数の増加に備えて確保しているものである。この動作のおかげで、要素を追加するたびにメモリを再確保する必要が無くなり、単に確保済みの領域を初期化するだけでよくなる(再確保は要素数の対数の頻度で発生する)。</p>
<p>領域の再確保が発生すると、全ての要素が新しい領域にコピーされるため非常にコストがかかる。このため、最終的な要素数が大きくなると解っている場合はあらかじめ<code><span style="color: #000">reserve()</span></code>メンバ関数で<code><span style="color: #000">capacity</span></code>を増加させておくことが望ましい。</p>
<p>各テンプレートパラメータの意味は次の通りである。</p>
<ul>
<li><code><span style="color: #000">T</span></code>: 格納される要素の型</li>
<li><code><span style="color: #000">Allocator</span></code>: メモリ確保に使用されるアロケータの型。無指定の場合は標準の<code><span style="color: #000">allocator</span></code>クラスが使用される。</li>
</ul>
<p>リファレンス中では、これらの名前をテンプレートパラメータとして扱う。</p>
<h2>メンバ関数</h2>
<h3>構築・破棄</h3>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/vector.html"><code><span style="color: #000">(constructor)</span></code></a></td>
<td>コンストラクタ</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/-vector.html"><code><span style="color: #000">(destructor)</span></code></a></td>
<td>デストラクタ</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_assign.html"><code><span style="color: #000">operator=</span></code></a></td>
<td>代入演算子</td>
<td></td>
</tr>
</tbody>
</table>
<h3>イテレータ</h3>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/begin.html"><code><span style="color: #000">begin</span></code></a></td>
<td>先頭の要素を指すイテレータを取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/end.html"><code><span style="color: #000">end</span></code></a></td>
<td>末尾の次を指すイテレータを取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/cbegin.html"><code><span style="color: #000">cbegin</span></code></a></td>
<td>先頭の要素を指す読み取り専用イテレータを取得する</td>
<td>C++11</td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/cend.html"><code><span style="color: #000">cend</span></code></a></td>
<td>末尾の次を指す読み取り専用イテレータを取得する</td>
<td>C++11</td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/rbegin.html"><code><span style="color: #000">rbegin</span></code></a></td>
<td>末尾を指す逆イテレータを取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/rend.html"><code><span style="color: #000">rend</span></code></a></td>
<td>先頭の前を指す逆イテレータを取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/crbegin.html"><code><span style="color: #000">crbegin</span></code></a></td>
<td>末尾を指す読み取り専用逆イテレータを取得する</td>
<td>C++11</td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/crend.html"><code><span style="color: #000">crend</span></code></a></td>
<td>先頭の前を指す読み取り専用逆イテレータを取得する</td>
<td>C++11</td>
</tr>
</tbody>
</table>
<h3>領域</h3>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/size.html"><code><span style="color: #000">size</span></code></a></td>
<td>要素数を取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/max_size.html"><code><span style="color: #000">max_size</span></code></a></td>
<td>格納可能な最大の要素数を取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/resize.html"><code><span style="color: #000">resize</span></code></a></td>
<td>要素数を変更する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/capacity.html"><code><span style="color: #000">capacity</span></code></a></td>
<td>メモリを再確保せずに格納できる最大の要素数を取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/empty.html"><code><span style="color: #000">empty</span></code></a></td>
<td>コンテナが空かどうかを判定する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/reserve.html"><code><span style="color: #000">reserve</span></code></a></td>
<td>capacityを変更する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/shrink_to_fit.html"><code><span style="color: #000">shrink_to_fit</span></code></a></td>
<td>capacityをsizeまで縮小する</td>
<td>C++11</td>
</tr>
</tbody>
</table>
<h3>要素アクセス</h3>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_at.html"><code><span style="color: #000">operator[]</span></code></a></td>
<td>要素アクセス</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/at.html"><code><span style="color: #000">at</span></code></a></td>
<td>要素アクセス</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/data.html"><code><span style="color: #000">data</span></code></a></td>
<td>配列の先頭へのポインタを取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/front.html"><code><span style="color: #000">front</span></code></a></td>
<td>先頭要素への参照を取得する</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/back.html"><code><span style="color: #000">back</span></code></a></td>
<td>末尾要素への参照を取得する</td>
<td></td>
</tr>
</tbody>
</table>
<h3>コンテナの変更</h3>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/assign.html"><code><span style="color: #000">assign</span></code></a></td>
<td>コンテナの再代入</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/push_back.html"><code><span style="color: #000">push_back</span></code></a></td>
<td>末尾へ要素追加</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/emplace_back.html"><code><span style="color: #000">emplace_back</span></code></a></td>
<td>末尾へ直接構築</td>
<td>C++11</td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/pop_back.html"><code><span style="color: #000">pop_back</span></code></a></td>
<td>末尾から要素削除</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/insert.html"><code><span style="color: #000">insert</span></code></a></td>
<td>要素の挿入</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/emplace.html"><code><span style="color: #000">emplace</span></code></a></td>
<td>要素の直接構築による挿入</td>
<td>C++11</td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/erase.html"><code><span style="color: #000">erase</span></code></a></td>
<td>要素の削除</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/swap.html"><code><span style="color: #000">swap</span></code></a></td>
<td>コンテナの交換</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/clear.html"><code><span style="color: #000">clear</span></code></a></td>
<td>全要素削除</td>
<td></td>
</tr>
</tbody>
</table>
<h3>アロケータ</h3>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/get_allocator.html"><code><span style="color: #000">get_allocator</span></code></a></td>
<td>アロケータオブジェクトの取得</td>
<td></td>
</tr>
</tbody>
</table>
<h2>メンバ型</h2>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><code><span style="color: #000">reference</span></code></td>
<td><code><span style="color: #000">T&amp;</span></code></td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">const_reference</span></code></td>
<td><code><span style="color: #000">const T&amp;</span></code></td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">iterator</span></code></td>
<td>ランダムアクセスイテレータ</td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">const_iterator</span></code></td>
<td>読み取り専用ランダムアクセスイテレータ</td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">size_type</span></code></td>
<td>符号なし整数型 (通常は<a href="http://cpprefjp.github.io/reference/cstddef/size_t.html"><code><span style="color: #000">size_t</span></code></a>)</td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">difference_type</span></code></td>
<td>符号付き整数型 (通常は<a href="http://cpprefjp.github.io/reference/cstddef/ptrdiff_t.html"><code><span style="color: #000">ptrdiff_t</span></code></a>)</td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">value_type</span></code></td>
<td>要素型 <code><span style="color: #000">T</span></code></td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">allocator_type</span></code></td>
<td>アロケータの型 <code><span style="color: #000">Allocator</span></code></td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">pointer</span></code></td>
<td><code><span style="color: #000">Allocator::pointer</span></code></td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">const_pointer</span></code></td>
<td><code><span style="color: #000">Allocator::const_pointer</span></code></td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">reverse_iterator</span></code></td>
<td><code><span style="color: #000">reverse_iterator&lt;iterator&gt;</span></code></td>
<td></td>
</tr>
<tr>
<td><code><span style="color: #000">const_reverse_iterator</span></code></td>
<td><code><span style="color: #000">reverse_iterator&lt;const_iterator&gt;</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<h2>非メンバ関数</h2>
<table border="1" bordercolor="#888" style="border-collapse:collapse">
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_equal.html"><code><span style="color: #000">operator==</span></code></a></td>
<td>等値比較</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_not_equal.html"><code><span style="color: #000">operator!=</span></code></a></td>
<td>非等値比較</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_less.html"><code><span style="color: #000">operator&lt;</span></code></a></td>
<td>左辺が右辺より小さいかの判定を行う</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_less_equal.html"><code><span style="color: #000">operator&lt;=</span></code></a></td>
<td>左辺が右辺以下かの判定を行う</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_greater.html"><code><span style="color: #000">operator&gt;</span></code></a></td>
<td>左辺が右辺より大きいかの判定を行う</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/op_greater_equal.html"><code><span style="color: #000">operator&gt;=</span></code></a></td>
<td>左辺が右辺以上かの判定を行う</td>
<td></td>
</tr>
<tr>
<td><a href="http://cpprefjp.github.io/reference/vector/swap_free.html"><code><span style="color: #000">swap</span></code></a></td>
<td>2つの<code><span style="color: #000">vector</span></code>オブジェクトを入れ替える</td>
<td></td>
</tr>
</tbody>
</table>
<h2>参照</h2>
<p><code><span style="color: #000">vector</span></code>のメモリ効率について</p>
<ul>
<li><a href="http://www.kmonos.net/wlog/111.html#_2334100705" target="_blank">２倍だけじゃない - Derive Your Dreams</a></li>
<li><a href="http://www.kmonos.net/wlog/111.html#_1001100720" target="_blank">それでも２倍だ - Derive Your Dreams</a></li>
</ul>
<h2><code><span style="color: #000">vector&lt;bool&gt;</span></code>特殊化</h2>
<p><code><span style="color: #000">vector</span></code>は<code><span style="color: #000">bool</span></code>型に対して特殊化されている。</p>
<p>この特殊化はメモリ領域を最小化するために提供されていて、各要素は1bitの領域のみを必要とする。</p>
<p><code><span style="color: #000">vector&lt;bool&gt;::reference</span></code>は<code><span style="color: #000">bool</span></code>への参照ではなく、領域内の1bitを指す型であり、以下のようなインタフェースである。</p>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">class vector&lt;bool&gt;::reference {
  friend class vector;
  reference();                              // コンストラクタは非公開
public:
  ~reference();
  operator bool() const;                    // boolへの暗黙変換
  reference&amp; operator=(const bool x);       // boolからの代入
  reference&amp; operator=(const reference&amp; x); // vector&lt;bool&gt;のビットからの代入
  void flip();                              // ビットの反転
}</span></code></pre>
</p>
<h3><code><span style="color: #000">vector&lt;bool&gt;</span></code>の基本操作：</h3>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;

int main()
{
  std::vector&lt;bool&gt; v(8, false);
  v[5] = true; // ビットを立てる
  v[7].flip(); // ビット反転(1だったら0、0だったら1にする)

//bool&amp; x = v[3]; // エラー！プロキシオブジェクトのため、bool&amp;には変換できない
  bool x = v[3]; // OK : コピーはできる
  std::cout &lt;&lt; "v[3] : " &lt;&lt; x &lt;&lt; std::endl;

  // イテレータ操作は可能
  std::for_each(v.begin(), v.end(), [](bool x) {
    std::cout &lt;&lt; x &lt;&lt; std::endl;
  });
}</span></code></pre>
</p>
<h3>出力</h3>
<p><pre><code><span style="color: #000">v[3] : 0
0
0
0
0
0
1
0
1
</span></code></pre>
<code><span style="color: #000">vector&lt;bool&gt;</span></code>の要素は参照するとプロキシオブジェクトのコピーが返ってくるため、RandomAccessIteratorの要件を満たさない。</p>
<h2>参照</h2>
<ul>
<li><a href="http://www.gotw.ca/publications/N1211.pdf" target="_blank">N1211 - <code><span style="color: #000">vector&lt;bool&gt;</span></code>: More Problems, Better Solutions</a></li>
<li>ビット配列に関しては、<a href="http://cpprefjp.github.io/reference/bitset.html"><code><span style="color: #000">bitset</span></code></a>(ビットを格納する固定長コンテナ)も参照。</li>
<li>可変長のビット配列の実装としては、Boost C++ Librariesの<a href="http://www.boost.org/doc/libs/release/libs/dynamic_bitset/dynamic_bitset.html" target="_blank"><code><span style="color: #000">dynamic_bitset</span></code></a>がある。</li>
</ul>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/vector.md" target="_blank">編集</a></footer>