<h1>declval (C++11)</h1>
<p><pre class="codehilite"><code class="language-cpp"><span style="color: #000">namespace std {
  template &lt;class T&gt;
  typename add_rvalue_reference&lt;T&gt;::type
    declval() noexcept; // as unevaluated operand
}</span></code></pre>
</p>
<h2>概要</h2>
<p>指定された型の値を得る。</p>
<p>この関数は、<code><span style="color: #000">decltype(expr)</span></code>や<code><span style="color: #000">noexcept(expr)</span></code> といった、実際には評価されない式の内部において、特定の型を持った式を作るためのヘルパ関数である。</p>
<h2>戻り値</h2>
<p>この関数は呼び出されないので、値としては何も返さない。</p>
<p>実際には評価されない文脈(<code><span style="color: #000">decltype</span></code>, <code><span style="color: #000">sizeof</span></code>, <code><span style="color: #000">noexcept</span></code>)で使用することで、指定された型に対する特定の演算が可能かどうかを調べるためだけの「型の値」が返る。</p>
<h2>例外</h2>
<p>投げない</p>
<h2>備考</h2>
<p>テンプレートパラメータ<code><span style="color: #000">T</span></code>は、不完全型であってもよい。</p>
<p>この関数が実際に評価されうる場合、プログラムは不適格となる。</p>
<h2>例</h2>
<p><pre class="codehilite"><code class="language-cpp"><span style="color:#ff0000">declval</span>&lt;From&gt;())) convert(From&amp;&amp; x)
{
  return static_cast&lt;To&gt;(std::forward&lt;From&gt;(x));
}

// std::<span style="color:#ff0000">declval</span>()は実際に評価してはいけない
/*
template &lt;class T&gt;
T f() { return std::<span style="color:#ff0000">declval</span>&lt;T&gt;(); }

void g()
{
  int x = f&lt;int&gt;(); // エラー！
}
*/

int main()
{
  int x = 3;
  double d = convert&lt;double&gt;(x);

  std::cout &lt;&lt; d &lt;&lt; std::endl;
}<span style="color: #000">#include &lt;iostream&gt;
#include &lt;utility&gt;

// この関数は、型Fromから型Toへの明示的な型変換が定義されている場合のみ
// オーバーロード解決の候補となる
template &lt;class To, class From&gt;
decltype(static_cast&lt;To&gt;(std::</span></code></pre>
</p>
<h3>出力</h3>
<p><pre><code><span style="color: #000">3
</span></code></pre></p>
<h2>バージョン</h2>
<h3>言語</h3>
<ul>
<li>C++11</li>
</ul>
<h3>処理系</h3>
<ul>
<li><a href="http://cpprefjp.github.io/implementation.html#clang">Clang</a>: ??</li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC</a>: </li>
<li><a href="http://cpprefjp.github.io/implementation.html#gcc">GCC, C++0x mode</a>: 4.7.0</li>
<li><a href="http://cpprefjp.github.io/implementation.html#icc">ICC</a>: ??</li>
<li><a href="http://cpprefjp.github.io/implementation.html#visual_cpp">Visual C++</a> ??</li>
</ul>
<h2>参照</h2>
<footer><a href="https://github.com/cpprefjp/site/edit/master/reference/utility/declval.md" target="_blank">編集</a></footer>