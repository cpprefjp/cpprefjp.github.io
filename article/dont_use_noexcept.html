<h1>標準ライブラリにおける、関数にnoexceptを付けない条件</h1>
<p>C++11から、<code><span style="color: #000">throw</span></code>キーワードを使用した関数の例外指示が非推奨になり、例外を投げないことを明示する<code><span style="color: #000">noexcept</span></code>キーワードが追加された。</p>
<p>標準ライブラリも<code><span style="color: #000">noexcept</span></code>に対応しているが、仕様上、自然言語で「Throws: Nothing.(例外を投げない)」と書いてあって、<code><span style="color: #000">noexcept</span></code>が付いていないものがいくつか存在する。</p>
<p>たとえば、<a href="http://cpprefjp.github.io/reference/mutex/mutex.html"><code><span style="color: #000">std::mutex</span></code></a>クラスの<a href="http://cpprefjp.github.io/reference/mutex/mutex/unlock.html"><code><span style="color: #000">unlock()</span></code></a>メンバ関数には、<code><span style="color: #000">noexcept</span></code>が付いていない。</p>
<p>これについては、「<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3279.pdf" target="_blank">N3279 - Conservative use of noexcept in the library</a>」のペーパーで論じられている。簡単に言えば、<code><span style="color: #000">noexcept</span></code>を付けない条件は以下のようになる：</p>
<p>関数に事前条件が設定されている場合(<code><span style="color: #000">unlock()</span></code>の場合は、すでにアンロックされていないこと)、事前条件の不一致を報告するために、実装が例外を投げる場合がある。そういう関数に対しては、<code><span style="color: #000">noexcept</span></code>は付いていない。</p>
<p>例外があることを前提としていない、C言語の互換ライブラリには、<code><span style="color: #000">noexcept</span></code>が付いている場合がある。たとえば、<a href="http://cpprefjp.github.io/reference/atomic/atomic_exchange.html"><code><span style="color: #000">atomic_exchange()</span></code></a>のような、<a href="http://cpprefjp.github.io/reference/atomic.html">アトミックライブラリ</a>の関数などには、<code><span style="color: #000">noexcept</span></code>が付いている。</p>
<h2>参照元</h2>
<p>この記事は、「<a href="http://d.hatena.ne.jp/faith_and_brave/20130620/1371715296" target="_blank">標準ライブラリにおける、関数にnoexceptを付けない条件 - Faith and Brave - C++で遊ぼう</a>」のブログエントリから転載し、修正を行っている。</p>
<footer><a href="https://github.com/cpprefjp/site/edit/master/article/dont_use_noexcept.md" target="_blank">編集</a></footer>